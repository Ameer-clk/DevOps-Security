import subprocess
import time
import requests

# Replace with your Slack webhook URL
slack_webhook_url = "https://hooks.slack.com/services/XXXX/XXXX/XXXX"

target_host = '51.112.140.102'
masscan_options = "-p1-65535 -sV --rate=100000 -e eth0 --open-only -oG -"

def send_slack_notification(message):
    data = {
        "text": message
    }
    response = requests.post(slack_webhook_url, json=data)
    if response.status_code != 200:
        print("Error sending Slack notification.")

def parse_masscan_output(masscan_output):
    open_ports = []
    for line in masscan_output.split("\n"):
        if "Ports" in line and "open" in line:
            port_info = line.split(" ")[-1].replace("]", "")
            open_ports.append(int(port_info.split("/")[0]))
    return open_ports

def main():
    print(f"Starting Masscan on {target_host}...\n")
    start_time = time.time()
    masscan_process = subprocess.Popen(["masscan", target_host, masscan_options], stdout=subprocess.PIPE, shell=False)
    output, _ = masscan_process.communicate()
    end_time = time.time()
    open_ports = parse_masscan_output(output.decode())
    print(f"\nPort scan completed in {end_time - start_time:.2f} seconds.\nOpen ports found: {open_ports}")
    for port in open_ports:
        message = f"ðŸ”´ Open Port Alert: Port {port}/tcp is open on {target_host}"
        send_slack_notification(message)

if __name__ == '__main__':
    main()

